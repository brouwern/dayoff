---
title: "f01) Retrieving multiple sequences"
author: "Nathan Brouwer"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Vignette Title}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  warnings = FALSE
)
```



## Retrieving a list of sequences from UniProt

In previous chapters, you learnt how to search for DNA or protein sequences in sequence databases such as the NCBI database and UniProt, using the SeqinR package (see chapter3.html).

For example, in the previous chapter), you learnt how to retrieve a single sequence from UniProt.

Oftentimes, it is useful to retrieve several sequences from UniProt at once if you have a list of UniProt accessions. The R function “retrieveseqs()” below is useful for this purpose:


As its input, you need to give it the function a vector containing the accessions for the sequences you wish to retrieve, as well as the name of the ACNUC sub-database that the sequences should be retrieved from. In this case, we want to retrieve sequences from UniProt, so the sequences should be in the “swissprot” ACNUC sub-database.

The retrieveseqs() function returns a list variable, in which each element is a vector containing one of the sequences.

For example, to retrieve the protein sequences for UniProt accessions P06747, P0C569, O56773 and Q5VKP1 (the accessions for rabies virus phosphoprotein, Mokola virus phosphoprotein, Lagos bat virus phosphoprotein and Western Caucasian bat virus phosphoprotein, respectively), you can type:

Make a vector containing the names of the sequences
```{r}
seqnames <- c("P06747", "P0C569", "O56773", "Q5VKP1")  
```

Retrieve the sequences and store them in list variable "seqs"
```{r}
seqs <- retrieveseqs(seqnames,"swissprot")             
```


Print out the number of sequences retrieved
```{r}
length(seqs)                                 
```


Get the first sequence
```{r}
seq1 <- seqs[[1]]                            
```

Print out the first 20 letters of the first sequence
```{r}
seq1[1:20]                                   
```

Get the second sequence
```{r}
seq2 <- seqs[[2]]  
```

Print out the first 20 letters of the second sequence
```{r}
seq2[1:20]                                   
```


The commands above use the function retrieveseqs() to retrieve two UniProt sequences. The sequences are returned in a list variable seqs. To access the elements in an R list variable, you need to use double square brackets. Therefore, the second element of the list variable is accessed by typing seqs[[2]]. Each element of the list variable seqs contains a vector which stores one of the sequences.

Rabies virus is the virus responsible for rabies, which is classified by the WHO as a neglected tropical disease. Mokola virus and rabies virus are closely related viruses that both belong to a group of viruses called the Lyssaviruses. Mokola virus causes a rabies-like infection in mammals including humans.

Once you have retrieved the sequences using retrieveseqs(), you can then use the function write.fasta() from the SeqinR package to write the sequences to a FASTA-format file. As its arguments (inputs), the write.fasta() function takes the list variable containing the sequences, and a vector containing the names of the sequences, and the name that you want to give to the FASTA-format file. For example:

```{r}
write.fasta(seqs, seqnames, file="phosphoproteins.fasta")
```

The command above will write the sequences in list variable seqs to a FASTA-format file called “phosphoproteins.fasta” in the “My Documents” folder on your computer.

